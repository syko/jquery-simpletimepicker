(function(d){d.fn.simpleTimePicker=function(e,g){function j(b){g=d.extend({},d.fn.simpleTimePicker.defaults,b.data("simpleTimePicker-options"),g);b.data("simpleTimePicker-options",g);return g}if(typeof e=="object"||!e)g=e,e="initialize";this.each(function(){var b=d(this);if(e=="initialize"){var a=j(b),c=d("<ol></ol>").attr({"class":"simpletimepicker-list"}),h=parseInt(a.start_time.split(":")[0]),f=parseInt(a.start_time.split(":")[1]),i=parseInt(a.end_time.split(":")[0]),g=parseInt(a.end_time.split(":")[1]);
a.start_minutes=h*60+f;a.end_minutes=i*60+g;a.interval_minutes=parseInt(a.interval);for(h=a.start_minutes;h<=a.end_minutes;h+=a.interval_minutes){f=""+Math.floor(h/60);for(i=""+h%60;f.length<2;)f="0"+f;for(;i.length<2;)i="0"+i;f=d("<a></a>").attr({href:"javascript: void(0);"}).text(f+":"+i).click(function(){});c.append(d("<li></li>").append(f))}c.delegate("a","click",function(a){b.val(d(this).text());b.simpleTimePicker("close");a.preventDefault()});c.hide();b.after(c);a.list=c;a.timepicker_open=false;
a.show_on?b.parent().find(a.show_on).click(function(a){b.attr("disabled")||(b.focus(),b.simpleTimePicker("toggle"),a.preventDefault(),a.stopPropagation())}):b.focus(function(){b.simpleTimePicker("open")});d(document).click(function(a){a.target!=b.get(0)&&b.simpleTimePicker("close")})}else e=="open"?(a=b.data("simpleTimePicker-options"),c=0,a.scroll_to_now&&(c=new Date,c=c.getHours()*60+c.getMinutes(),c=-Math.floor((c-a.start_minutes)/a.interval_minutes)*a.list.find("a:first").outerHeight(true),c>
0&&(c=0)),a.list.css({position:"absolute",top:b.position().top+c,left:b.position().left+b.outerWidth()+a.distance_left}).show(),a.list.css({top:"-="+Math.min(0,a.list.position().top)}),a.list.css({top:"+="+Math.min(0,d(window).height()-a.list.position().top-a.list.height())}),a.timepicker_open=true):e=="close"?(a=b.data("simpleTimePicker-options"),a.list.hide(),a.timepicker_open=false):e=="toggle"&&(a=b.data("simpleTimePicker-options"),a.timepicker_open?b.simpleTimePicker("close"):b.simpleTimePicker("open"))})};
d.fn.simpleTimePicker.defaults={start_time:"9:00",end_time:"22:30",interval:"30",show_on:null,distance_left:0,scroll_to_now:true}})(jQuery);
